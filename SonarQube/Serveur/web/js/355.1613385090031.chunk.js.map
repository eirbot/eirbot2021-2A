{"version":3,"sources":["webpack:///./src/main/js/apps/permission-templates/utils.ts","webpack:///./src/main/js/apps/permission-templates/components/Form.tsx","webpack:///./src/main/js/apps/permission-templates/components/Header.tsx","webpack:///./src/main/js/apps/permission-templates/components/ListHeader.tsx","webpack:///./src/main/js/apps/permission-templates/components/DeleteForm.tsx","webpack:///./src/main/js/apps/permission-templates/components/ActionsCell.tsx","webpack:///./src/main/js/apps/permission-templates/components/Defaults.tsx","webpack:///./src/main/js/apps/permission-templates/components/NameCell.tsx","webpack:///./src/main/js/apps/permission-templates/components/PermissionCell.tsx","webpack:///./src/main/js/apps/permission-templates/components/ListItem.tsx","webpack:///./src/main/js/apps/permission-templates/components/List.tsx","webpack:///./src/main/js/apps/permission-templates/components/Home.tsx","webpack:///./src/main/js/apps/permission-templates/components/TemplateDetails.tsx","webpack:///./src/main/js/apps/permission-templates/components/TemplateHeader.tsx","webpack:///./src/main/js/apps/permission-templates/components/Template.tsx","webpack:///./src/main/js/apps/permission-templates/components/App.tsx","webpack:///./src/main/js/app/components/embed-docs-modal/Suggestions.tsx"],"names":["PERMISSIONS_ORDER","sortPermissions","permissions","p","indexOf","mergePermissionsToTemplates","permissionTemplates","basePermissions","map","permissionTemplate","basePermission","projectPermission","find","key","usersCount","groupsCount","mergeDefaultsToTemplates","defaultTemplates","defaultFor","forEach","defaultTemplate","templateId","id","push","qualifier","props","mounted","handleSubmit","onSubmit","description","state","name","projectKeyPattern","then","onClose","handleNameChange","event","setState","currentTarget","value","handleDescriptionChange","handleProjectKeyPatternChange","render","header","this","size","onCloseClick","onFormSubmit","submitting","className","htmlFor","autoFocus","maxLength","onChange","required","type","loading","disabled","confirmButtonText","onClick","createModal","handleCreateClick","handleCreateModalClose","handleCreateModalSubmit","data","response","refresh","router","pathname","query","componentDidMount","componentWillUnmount","ready","withRouter","renderTooltip","permission","InstanceMessage","message","Alert","variant","cells","overlay","DeleteForm","t","deleteForm","updateModal","handleUpdateClick","handleCloseUpdateModal","handleSubmitUpdateModal","handleDeleteClick","handleCloseDeleteForm","handleDeleteSubmit","replace","setDefault","getAvailableQualifiers","topQualifiers","renderSetDefaultsControl","availableQualifiers","length","renderIfSingleTopQualifier","renderIfMultipleTopQualifiers","renderSetDefaultLink","child","ActionsDropdown","fromDetails","to","destructive","Defaults","qualifiersToDisplay","qualifiers","join","NameCell","template","PermissionCell","withProjectCreator","ListItem","List","Home","defer","title","TemplateDetails","TemplateHeader","filter","groups","users","requestHolders","realQuery","selectedPermission","requests","finalQuery","Promise","resolve","all","handleToggleUser","user","login","handleToggleProjectCreator","hasPermission","includes","handleToggleGroup","group","groupName","handleSearch","handleFilter","handleSelectPermission","undefined","shouldDisplayCreator","creatorPermissions","CREATOR_NAME","isFiltered","matchQuery","toLocaleLowerCase","toLowerCase","matchPermission","allUsers","creator","unshift","HoldersList","onSelectPermission","onToggleGroup","onToggleUser","showPublicProjectsWarning","SearchForm","onFilter","onSearch","requestPermissions","sortedPerm","permissionTemplatesMerged","renderTemplate","renderHome","location","Suggestions","suggestions","Consumer","addSuggestions","removeSuggestions","SuggestionsInner","componentDidUpdate","prevProps"],"mappings":"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","file":"js/355.1613385090031.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { sortBy } from 'lodash';\n\nexport const PERMISSIONS_ORDER = [\n  'user',\n  'codeviewer',\n  'issueadmin',\n  'securityhotspotadmin',\n  'admin',\n  'scan'\n];\n\nexport const PERMISSION_TEMPLATES_PATH = '/permission_templates';\n\nexport function sortPermissions(permissions: T.Permission[]) {\n  return sortBy(permissions, p => PERMISSIONS_ORDER.indexOf(p.key));\n}\n\nexport function mergePermissionsToTemplates(\n  permissionTemplates: T.PermissionTemplate[],\n  basePermissions: T.Permission[]\n): T.PermissionTemplate[] {\n  return permissionTemplates.map(permissionTemplate => {\n    // it's important to keep the order of the permission template's permissions\n    // the same as the order of base permissions\n    const permissions = basePermissions.map(basePermission => {\n      const projectPermission = permissionTemplate.permissions.find(\n        p => p.key === basePermission.key\n      );\n      return { usersCount: 0, groupsCount: 0, ...basePermission, ...projectPermission };\n    });\n\n    return { ...permissionTemplate, permissions };\n  });\n}\n\nexport function mergeDefaultsToTemplates(\n  permissionTemplates: T.PermissionTemplate[],\n  defaultTemplates: Array<{ templateId: string; qualifier: string }> = []\n): T.PermissionTemplate[] {\n  return permissionTemplates.map(permissionTemplate => {\n    const defaultFor: string[] = [];\n\n    defaultTemplates.forEach(defaultTemplate => {\n      if (defaultTemplate.templateId === permissionTemplate.id) {\n        defaultFor.push(defaultTemplate.qualifier);\n      }\n    });\n\n    return { ...permissionTemplate, defaultFor };\n  });\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport SimpleModal from 'sonar-ui-common/components/controls/SimpleModal';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  confirmButtonText: string;\n  header: string;\n  onClose: () => void;\n  onSubmit: (data: {\n    description: string;\n    name: string;\n    projectKeyPattern: string;\n  }) => Promise<void>;\n  permissionTemplate?: { description?: string; name: string; projectKeyPattern?: string };\n}\n\ninterface State {\n  description: string;\n  name: string;\n  projectKeyPattern: string;\n}\n\nexport default class Form extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      description: (props.permissionTemplate && props.permissionTemplate.description) || '',\n      name: (props.permissionTemplate && props.permissionTemplate.name) || '',\n      projectKeyPattern:\n        (props.permissionTemplate && props.permissionTemplate.projectKeyPattern) || ''\n    };\n  }\n\n  handleSubmit = () => {\n    return this.props\n      .onSubmit({\n        description: this.state.description,\n        name: this.state.name,\n        projectKeyPattern: this.state.projectKeyPattern\n      })\n      .then(this.props.onClose);\n  };\n\n  handleNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ name: event.currentTarget.value });\n  };\n\n  handleDescriptionChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    this.setState({ description: event.currentTarget.value });\n  };\n\n  handleProjectKeyPatternChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ projectKeyPattern: event.currentTarget.value });\n  };\n\n  render() {\n    return (\n      <SimpleModal\n        header={this.props.header}\n        onClose={this.props.onClose}\n        onSubmit={this.handleSubmit}\n        size=\"small\">\n        {({ onCloseClick, onFormSubmit, submitting }) => (\n          <form id=\"permission-template-form\" onSubmit={onFormSubmit}>\n            <header className=\"modal-head\">\n              <h2>{this.props.header}</h2>\n            </header>\n\n            <div className=\"modal-body\">\n              <div className=\"modal-field\">\n                <label htmlFor=\"permission-template-name\">\n                  {translate('name')}\n                  <em className=\"mandatory\">*</em>\n                </label>\n                <input\n                  autoFocus={true}\n                  id=\"permission-template-name\"\n                  maxLength={256}\n                  name=\"name\"\n                  onChange={this.handleNameChange}\n                  required={true}\n                  type=\"text\"\n                  value={this.state.name}\n                />\n                <div className=\"modal-field-description\">{translate('should_be_unique')}</div>\n              </div>\n\n              <div className=\"modal-field\">\n                <label htmlFor=\"permission-template-description\">{translate('description')}</label>\n                <textarea\n                  id=\"permission-template-description\"\n                  name=\"description\"\n                  onChange={this.handleDescriptionChange}\n                  value={this.state.description}\n                />\n              </div>\n\n              <div className=\"modal-field\">\n                <label htmlFor=\"permission-template-project-key-pattern\">\n                  {translate('permission_template.key_pattern')}\n                </label>\n                <input\n                  id=\"permission-template-project-key-pattern\"\n                  maxLength={500}\n                  name=\"projectKeyPattern\"\n                  onChange={this.handleProjectKeyPatternChange}\n                  type=\"text\"\n                  value={this.state.projectKeyPattern}\n                />\n                <div className=\"modal-field-description\">\n                  {translate('permission_template.key_pattern.description')}\n                </div>\n              </div>\n            </div>\n\n            <footer className=\"modal-foot\">\n              <DeferredSpinner className=\"spacer-right\" loading={submitting} />\n              <SubmitButton disabled={submitting} id=\"permission-template-submit\">\n                {this.props.confirmButtonText}\n              </SubmitButton>\n              <ResetButtonLink\n                disabled={submitting}\n                id=\"permission-template-cancel\"\n                onClick={onCloseClick}>\n                {translate('cancel')}\n              </ResetButtonLink>\n            </footer>\n          </form>\n        )}\n      </SimpleModal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { createPermissionTemplate } from '../../../api/permissions';\nimport { Router, withRouter } from '../../../components/hoc/withRouter';\nimport { PERMISSION_TEMPLATES_PATH } from '../utils';\nimport Form from './Form';\n\ninterface Props {\n  ready?: boolean;\n  refresh: () => Promise<void>;\n  router: Pick<Router, 'push'>;\n}\n\ninterface State {\n  createModal: boolean;\n}\n\nclass Header extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { createModal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleCreateClick = () => {\n    this.setState({ createModal: true });\n  };\n\n  handleCreateModalClose = () => {\n    if (this.mounted) {\n      this.setState({ createModal: false });\n    }\n  };\n\n  handleCreateModalSubmit = (data: {\n    description: string;\n    name: string;\n    projectKeyPattern: string;\n  }) => {\n    return createPermissionTemplate({ ...data }).then(response => {\n      this.props.refresh().then(() => {\n        this.props.router.push({\n          pathname: PERMISSION_TEMPLATES_PATH,\n          query: { id: response.permissionTemplate.id }\n        });\n      });\n    });\n  };\n\n  render() {\n    return (\n      <header className=\"page-header\" id=\"project-permissions-header\">\n        <h1 className=\"page-title\">{translate('permission_templates.page')}</h1>\n\n        {!this.props.ready && <i className=\"spinner\" />}\n\n        <div className=\"page-actions\">\n          <Button onClick={this.handleCreateClick}>{translate('create')}</Button>\n\n          {this.state.createModal && (\n            <Form\n              confirmButtonText={translate('create')}\n              header={translate('permission_template.new_template')}\n              onClose={this.handleCreateModalClose}\n              onSubmit={this.handleCreateModalSubmit}\n            />\n          )}\n        </div>\n\n        <p className=\"page-description\">{translate('permission_templates.page.description')}</p>\n      </header>\n    );\n  }\n}\n\nexport default withRouter(Header);\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport InstanceMessage from '../../../components/common/InstanceMessage';\n\ninterface Props {\n  permissions: T.Permission[];\n}\n\nexport default class ListHeader extends React.PureComponent<Props> {\n  renderTooltip(permission: T.Permission) {\n    return permission.key === 'user' || permission.key === 'codeviewer' ? (\n      <div>\n        <InstanceMessage message={translate('projects_role', permission.key, 'desc')} />\n        <Alert className=\"spacer-top\" variant=\"warning\">\n          {translate('projects_role.public_projects_warning')}\n        </Alert>\n      </div>\n    ) : (\n      <InstanceMessage message={translate('projects_role', permission.key, 'desc')} />\n    );\n  }\n\n  render() {\n    const cells = this.props.permissions.map(permission => (\n      <th className=\"permission-column little-padded-left little-padded-right\" key={permission.key}>\n        <div className=\"permission-column-inner\">\n          <span className=\"text-middle\">{translate('projects_role', permission.key)}</span>\n          <HelpTooltip className=\"spacer-left\" overlay={this.renderTooltip(permission)} />\n        </div>\n      </th>\n    ));\n\n    return (\n      <thead>\n        <tr>\n          <th className=\"little-padded-left little-padded-right\">&nbsp;</th>\n          {cells}\n          <th className=\"thin nowrap text-right little-padded-left little-padded-right\">&nbsp;</th>\n        </tr>\n      </thead>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport SimpleModal from 'sonar-ui-common/components/controls/SimpleModal';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  onClose: () => void;\n  onSubmit: () => Promise<void>;\n  permissionTemplate: T.PermissionTemplate;\n}\n\nexport default function DeleteForm({ onClose, onSubmit, permissionTemplate: t }: Props) {\n  const header = translate('permission_template.delete_confirm_title');\n\n  return (\n    <SimpleModal header={header} onClose={onClose} onSubmit={onSubmit}>\n      {({ onCloseClick, onFormSubmit, submitting }) => (\n        <form onSubmit={onFormSubmit}>\n          <header className=\"modal-head\">\n            <h2>{header}</h2>\n          </header>\n\n          <div className=\"modal-body\">\n            {translateWithParameters(\n              'permission_template.do_you_want_to_delete_template_xxx',\n              t.name\n            )}\n          </div>\n\n          <footer className=\"modal-foot\">\n            <DeferredSpinner className=\"spacer-right\" loading={submitting} />\n            <SubmitButton className=\"button-red\" disabled={submitting}>\n              {translate('delete')}\n            </SubmitButton>\n            <ResetButtonLink disabled={submitting} onClick={onCloseClick}>\n              {translate('cancel')}\n            </ResetButtonLink>\n          </footer>\n        </form>\n      )}\n    </SimpleModal>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { difference } from 'lodash';\nimport * as React from 'react';\nimport ActionsDropdown, {\n  ActionsDropdownItem\n} from 'sonar-ui-common/components/controls/ActionsDropdown';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport {\n  deletePermissionTemplate,\n  setDefaultPermissionTemplate,\n  updatePermissionTemplate\n} from '../../../api/permissions';\nimport { Router, withRouter } from '../../../components/hoc/withRouter';\nimport { PERMISSION_TEMPLATES_PATH } from '../utils';\nimport DeleteForm from './DeleteForm';\nimport Form from './Form';\n\ninterface Props {\n  fromDetails?: boolean;\n  permissionTemplate: T.PermissionTemplate;\n  refresh: () => void;\n  router: Pick<Router, 'replace'>;\n  topQualifiers: string[];\n}\n\ninterface State {\n  deleteForm: boolean;\n  updateModal: boolean;\n}\n\nexport class ActionsCell extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { deleteForm: false, updateModal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleUpdateClick = () => {\n    this.setState({ updateModal: true });\n  };\n\n  handleCloseUpdateModal = () => {\n    if (this.mounted) {\n      this.setState({ updateModal: false });\n    }\n  };\n\n  handleSubmitUpdateModal = (data: {\n    description: string;\n    name: string;\n    projectKeyPattern: string;\n  }) => {\n    return updatePermissionTemplate({ id: this.props.permissionTemplate.id, ...data }).then(\n      this.props.refresh\n    );\n  };\n\n  handleDeleteClick = () => {\n    this.setState({ deleteForm: true });\n  };\n\n  handleCloseDeleteForm = () => {\n    if (this.mounted) {\n      this.setState({ deleteForm: false });\n    }\n  };\n\n  handleDeleteSubmit = () => {\n    return deletePermissionTemplate({ templateId: this.props.permissionTemplate.id }).then(() => {\n      this.props.router.replace(PERMISSION_TEMPLATES_PATH);\n      this.props.refresh();\n    });\n  };\n\n  setDefault = (qualifier: string) => () => {\n    setDefaultPermissionTemplate(this.props.permissionTemplate.id, qualifier).then(\n      this.props.refresh,\n      () => {}\n    );\n  };\n\n  getAvailableQualifiers() {\n    return difference(this.props.topQualifiers, this.props.permissionTemplate.defaultFor);\n  }\n\n  renderSetDefaultsControl() {\n    const availableQualifiers = this.getAvailableQualifiers();\n\n    if (availableQualifiers.length === 0) {\n      return null;\n    }\n\n    return this.props.topQualifiers.length === 1\n      ? this.renderIfSingleTopQualifier(availableQualifiers)\n      : this.renderIfMultipleTopQualifiers(availableQualifiers);\n  }\n\n  renderSetDefaultLink(qualifier: string, child: React.ReactNode) {\n    return (\n      <ActionsDropdownItem\n        className=\"js-set-default\"\n        data-qualifier={qualifier}\n        key={qualifier}\n        onClick={this.setDefault(qualifier)}>\n        {child}\n      </ActionsDropdownItem>\n    );\n  }\n\n  renderIfSingleTopQualifier(availableQualifiers: string[]) {\n    return availableQualifiers.map(qualifier =>\n      this.renderSetDefaultLink(\n        qualifier,\n        <span>{translate('permission_templates.set_default')}</span>\n      )\n    );\n  }\n\n  renderIfMultipleTopQualifiers(availableQualifiers: string[]) {\n    return availableQualifiers.map(qualifier =>\n      this.renderSetDefaultLink(\n        qualifier,\n        <span>\n          {translate('permission_templates.set_default_for')}{' '}\n          <QualifierIcon qualifier={qualifier} /> {translate('qualifiers', qualifier)}\n        </span>\n      )\n    );\n  }\n\n  render() {\n    const { permissionTemplate: t } = this.props;\n\n    return (\n      <>\n        <ActionsDropdown>\n          {this.renderSetDefaultsControl()}\n\n          {!this.props.fromDetails && (\n            <ActionsDropdownItem to={{ pathname: PERMISSION_TEMPLATES_PATH, query: { id: t.id } }}>\n              {translate('edit_permissions')}\n            </ActionsDropdownItem>\n          )}\n\n          <ActionsDropdownItem className=\"js-update\" onClick={this.handleUpdateClick}>\n            {translate('update_details')}\n          </ActionsDropdownItem>\n\n          {t.defaultFor.length === 0 && (\n            <ActionsDropdownItem\n              className=\"js-delete\"\n              destructive={true}\n              onClick={this.handleDeleteClick}>\n              {translate('delete')}\n            </ActionsDropdownItem>\n          )}\n        </ActionsDropdown>\n\n        {this.state.updateModal && (\n          <Form\n            confirmButtonText={translate('update_verb')}\n            header={translate('permission_template.edit_template')}\n            onClose={this.handleCloseUpdateModal}\n            onSubmit={this.handleSubmitUpdateModal}\n            permissionTemplate={t}\n          />\n        )}\n\n        {this.state.deleteForm && (\n          <DeleteForm\n            onClose={this.handleCloseDeleteForm}\n            onSubmit={this.handleDeleteSubmit}\n            permissionTemplate={t}\n          />\n        )}\n      </>\n    );\n  }\n}\n\nexport default withRouter(ActionsCell);\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { sortBy } from 'lodash';\nimport * as React from 'react';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  template: T.PermissionTemplate;\n}\n\nexport default function Defaults({ template }: Props) {\n  const qualifiersToDisplay = template.defaultFor;\n\n  const qualifiers = sortBy(qualifiersToDisplay)\n    .map(qualifier => translate('qualifiers', qualifier))\n    .join(', ');\n\n  return (\n    <div>\n      <span className=\"badge spacer-right\">\n        {translateWithParameters('permission_template.default_for', qualifiers)}\n      </span>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { PERMISSION_TEMPLATES_PATH } from '../utils';\nimport Defaults from './Defaults';\n\ninterface Props {\n  template: T.PermissionTemplate;\n}\n\nexport default function NameCell({ template }: Props) {\n  const pathname = PERMISSION_TEMPLATES_PATH;\n\n  return (\n    <td className=\"little-padded-left little-padded-right\">\n      <Link to={{ pathname, query: { id: template.id } }}>\n        <strong className=\"js-name\">{template.name}</strong>\n      </Link>\n\n      {template.defaultFor.length > 0 && (\n        <div className=\"spacer-top js-defaults\">\n          <Defaults template={template} />\n        </div>\n      )}\n\n      {!!template.description && (\n        <div className=\"spacer-top js-description\">{template.description}</div>\n      )}\n\n      {!!template.projectKeyPattern && (\n        <div className=\"spacer-top js-project-key-pattern\">\n          Project Key Pattern: <code>{template.projectKeyPattern}</code>\n        </div>\n      )}\n    </td>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { isSonarCloud } from '../../../helpers/system';\n\ninterface Props {\n  permission: {\n    key: string;\n    usersCount: number;\n    groupsCount: number;\n    withProjectCreator?: boolean;\n  };\n}\n\nexport default function PermissionCell({ permission: p }: Props) {\n  return (\n    <td className=\"permission-column little-padded-left little-padded-right\">\n      <div className=\"permission-column-inner\">\n        <ul>\n          {p.withProjectCreator && (\n            <li className=\"little-spacer-bottom display-flex-center\">\n              {translate('permission_templates.project_creators')}\n              <HelpTooltip\n                className=\"little-spacer-left\"\n                overlay={translate(\n                  isSonarCloud()\n                    ? 'permission_templates.project_creators.explanation.sonarcloud'\n                    : 'permission_templates.project_creators.explanation'\n                )}\n              />\n            </li>\n          )}\n          <li className=\"little-spacer-bottom\">\n            <strong>{p.usersCount}</strong>\n            {'  user(s)'}\n          </li>\n          <li>\n            <strong>{p.groupsCount}</strong>\n            {' group(s)'}\n          </li>\n        </ul>\n      </div>\n    </td>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ActionsCell from './ActionsCell';\nimport NameCell from './NameCell';\nimport PermissionCell from './PermissionCell';\n\ninterface Props {\n  refresh: () => Promise<void>;\n  template: T.PermissionTemplate;\n  topQualifiers: string[];\n}\n\nexport default function ListItem(props: Props) {\n  const permissions = props.template.permissions.map(p => (\n    <PermissionCell key={p.key} permission={p} />\n  ));\n\n  return (\n    <tr data-id={props.template.id} data-name={props.template.name}>\n      <NameCell template={props.template} />\n\n      {permissions}\n\n      <td className=\"nowrap thin text-right text-top little-padded-left little-padded-right\">\n        <ActionsCell\n          permissionTemplate={props.template}\n          refresh={props.refresh}\n          topQualifiers={props.topQualifiers}\n        />\n      </td>\n    </tr>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ListHeader from './ListHeader';\nimport ListItem from './ListItem';\n\ninterface Props {\n  permissionTemplates: T.PermissionTemplate[];\n  permissions: T.Permission[];\n  refresh: () => Promise<void>;\n  topQualifiers: string[];\n}\n\nexport default function List(props: Props) {\n  const permissionTemplates = props.permissionTemplates.map(p => (\n    <ListItem key={p.id} refresh={props.refresh} template={p} topQualifiers={props.topQualifiers} />\n  ));\n\n  return (\n    <div className=\"boxed-group boxed-group-inner\">\n      <table className=\"data zebra permissions-table\" id=\"permission-templates\">\n        <ListHeader permissions={props.permissions} />\n        <tbody>{permissionTemplates}</tbody>\n      </table>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport Header from './Header';\nimport List from './List';\n\ninterface Props {\n  permissionTemplates: T.PermissionTemplate[];\n  permissions: T.Permission[];\n  ready: boolean;\n  refresh: () => Promise<void>;\n  topQualifiers: string[];\n}\n\nexport default function Home(props: Props) {\n  return (\n    <div className=\"page page-limited\">\n      <Helmet defer={false} title={translate('permission_templates.page')} />\n\n      <Header ready={props.ready} refresh={props.refresh} />\n\n      <List\n        permissionTemplates={props.permissionTemplates}\n        permissions={props.permissions}\n        refresh={props.refresh}\n        topQualifiers={props.topQualifiers}\n      />\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Defaults from './Defaults';\n\ninterface Props {\n  template: T.PermissionTemplate;\n}\n\nexport default function TemplateDetails({ template }: Props) {\n  return (\n    <div className=\"big-spacer-bottom\">\n      {template.defaultFor.length > 0 && (\n        <div className=\"spacer-top js-defaults\">\n          <Defaults template={template} />\n        </div>\n      )}\n\n      {!!template.description && (\n        <div className=\"spacer-top js-description\">{template.description}</div>\n      )}\n\n      {!!template.projectKeyPattern && (\n        <div className=\"spacer-top js-project-key-pattern\">\n          Project Key Pattern: <code>{template.projectKeyPattern}</code>\n        </div>\n      )}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { PERMISSION_TEMPLATES_PATH } from '../utils';\nimport ActionsCell from './ActionsCell';\n\ninterface Props {\n  loading: boolean;\n  refresh: () => void;\n  template: T.PermissionTemplate;\n  topQualifiers: string[];\n}\n\nexport default function TemplateHeader(props: Props) {\n  const { template } = props;\n  return (\n    <header className=\"page-header\" id=\"project-permissions-header\">\n      <div className=\"note spacer-bottom\">\n        <Link className=\"text-muted\" to={PERMISSION_TEMPLATES_PATH}>\n          {translate('permission_templates.page')}\n        </Link>\n      </div>\n\n      <h1 className=\"page-title\">{template.name}</h1>\n\n      {props.loading && <i className=\"spinner\" />}\n\n      <div className=\"pull-right\">\n        <ActionsCell\n          fromDetails={true}\n          permissionTemplate={template}\n          refresh={props.refresh}\n          topQualifiers={props.topQualifiers}\n        />\n      </div>\n    </header>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport * as api from '../../../api/permissions';\nimport HoldersList from '../../permissions/shared/components/HoldersList';\nimport SearchForm from '../../permissions/shared/components/SearchForm';\nimport {\n  convertToPermissionDefinitions,\n  PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE\n} from '../../permissions/utils';\nimport TemplateDetails from './TemplateDetails';\nimport TemplateHeader from './TemplateHeader';\n\ninterface Props {\n  refresh: () => void;\n  template: T.PermissionTemplate;\n  topQualifiers: string[];\n}\n\ninterface State {\n  filter: string;\n  groups: T.PermissionGroup[];\n  loading: boolean;\n  query: string;\n  selectedPermission?: string;\n  users: T.PermissionUser[];\n}\n\nexport default class Template extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {\n    filter: 'all',\n    groups: [],\n    loading: false,\n    query: '',\n    users: []\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.requestHolders();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  requestHolders = (realQuery?: string) => {\n    this.setState({ loading: true });\n\n    const { template } = this.props;\n    const { query, filter, selectedPermission } = this.state;\n    const requests = [];\n\n    const finalQuery = realQuery != null ? realQuery : query;\n\n    if (filter !== 'groups') {\n      requests.push(api.getPermissionTemplateUsers(template.id, finalQuery, selectedPermission));\n    } else {\n      requests.push(Promise.resolve([]));\n    }\n\n    if (filter !== 'users') {\n      requests.push(api.getPermissionTemplateGroups(template.id, finalQuery, selectedPermission));\n    } else {\n      requests.push(Promise.resolve([]));\n    }\n    return Promise.all(requests).then(([users, groups]) => {\n      if (this.mounted) {\n        this.setState({\n          users,\n          groups,\n          loading: false\n        });\n      }\n    });\n  };\n\n  handleToggleUser = (user: T.PermissionUser, permission: string) => {\n    if (user.login === '<creator>') {\n      return this.handleToggleProjectCreator(user, permission);\n    }\n    const { template } = this.props;\n    const hasPermission = user.permissions.includes(permission);\n    const data: { templateId: string; login: string; permission: string } = {\n      templateId: template.id,\n      login: user.login,\n      permission\n    };\n\n    const request = hasPermission\n      ? api.revokeTemplatePermissionFromUser(data)\n      : api.grantTemplatePermissionToUser(data);\n    return request.then(() => this.requestHolders()).then(this.props.refresh);\n  };\n\n  handleToggleProjectCreator = (user: T.PermissionUser, permission: string) => {\n    const { template } = this.props;\n    const hasPermission = user.permissions.includes(permission);\n    const request = hasPermission\n      ? api.removeProjectCreatorFromTemplate(template.id, permission)\n      : api.addProjectCreatorToTemplate(template.id, permission);\n    return request.then(() => this.requestHolders()).then(this.props.refresh);\n  };\n\n  handleToggleGroup = (group: T.PermissionGroup, permission: string) => {\n    const { template } = this.props;\n    const hasPermission = group.permissions.includes(permission);\n    const data = {\n      templateId: template.id,\n      groupName: group.name,\n      permission\n    };\n    const request = hasPermission\n      ? api.revokeTemplatePermissionFromGroup(data)\n      : api.grantTemplatePermissionToGroup(data);\n    return request.then(() => this.requestHolders()).then(this.props.refresh);\n  };\n\n  handleSearch = (query: string) => {\n    this.setState({ query });\n    this.requestHolders(query);\n  };\n\n  handleFilter = (filter: string) => {\n    this.setState({ filter }, this.requestHolders);\n  };\n\n  handleSelectPermission = (selectedPermission: string) => {\n    if (selectedPermission === this.state.selectedPermission) {\n      this.setState({ selectedPermission: undefined }, this.requestHolders);\n    } else {\n      this.setState({ selectedPermission }, this.requestHolders);\n    }\n  };\n\n  shouldDisplayCreator = (creatorPermissions: string[]) => {\n    const { filter, query, selectedPermission } = this.state;\n    const CREATOR_NAME = translate('permission_templates.project_creators');\n\n    const isFiltered = filter !== 'all';\n\n    const matchQuery = !query || CREATOR_NAME.toLocaleLowerCase().includes(query.toLowerCase());\n\n    const matchPermission =\n      selectedPermission === undefined || creatorPermissions.includes(selectedPermission);\n\n    return !isFiltered && matchQuery && matchPermission;\n  };\n\n  render() {\n    const permissions = convertToPermissionDefinitions(\n      PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE,\n      'projects_role'\n    );\n    const allUsers = [...this.state.users];\n\n    const creatorPermissions = this.props.template.permissions\n      .filter(p => p.withProjectCreator)\n      .map(p => p.key);\n\n    if (this.shouldDisplayCreator(creatorPermissions)) {\n      const creator = {\n        login: '<creator>',\n        name: translate('permission_templates.project_creators'),\n        permissions: creatorPermissions\n      };\n\n      allUsers.unshift(creator);\n    }\n\n    return (\n      <div className=\"page page-limited\">\n        <Helmet defer={false} title={this.props.template.name} />\n\n        <TemplateHeader\n          loading={this.state.loading}\n          refresh={this.props.refresh}\n          template={this.props.template}\n          topQualifiers={this.props.topQualifiers}\n        />\n\n        <TemplateDetails template={this.props.template} />\n\n        <HoldersList\n          groups={this.state.groups}\n          onSelectPermission={this.handleSelectPermission}\n          onToggleGroup={this.handleToggleGroup}\n          onToggleUser={this.handleToggleUser}\n          permissions={permissions}\n          selectedPermission={this.state.selectedPermission}\n          showPublicProjectsWarning={true}\n          users={allUsers}>\n          <SearchForm\n            filter={this.state.filter}\n            onFilter={this.handleFilter}\n            onSearch={this.handleSearch}\n            query={this.state.query}\n          />\n        </HoldersList>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { Location } from 'history';\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { connect } from 'react-redux';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getPermissionTemplates } from '../../../api/permissions';\nimport Suggestions from '../../../app/components/embed-docs-modal/Suggestions';\nimport { getAppState, Store } from '../../../store/rootReducer';\nimport '../../permissions/styles.css';\nimport { mergeDefaultsToTemplates, mergePermissionsToTemplates, sortPermissions } from '../utils';\nimport Home from './Home';\nimport Template from './Template';\n\ninterface Props {\n  location: Location;\n  topQualifiers: string[];\n}\n\ninterface State {\n  ready: boolean;\n  permissions: T.Permission[];\n  permissionTemplates: T.PermissionTemplate[];\n}\n\nexport class App extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {\n    ready: false,\n    permissions: [],\n    permissionTemplates: []\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.requestPermissions();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  requestPermissions = async () => {\n    const { permissions, defaultTemplates, permissionTemplates } = await getPermissionTemplates();\n\n    if (this.mounted) {\n      const sortedPerm = sortPermissions(permissions);\n      const permissionTemplatesMerged = mergeDefaultsToTemplates(\n        mergePermissionsToTemplates(permissionTemplates, sortedPerm),\n        defaultTemplates\n      );\n      this.setState({\n        ready: true,\n        permissionTemplates: permissionTemplatesMerged,\n        permissions: sortedPerm\n      });\n    }\n  };\n\n  renderTemplate(id: string) {\n    if (!this.state.ready) {\n      return null;\n    }\n\n    const template = this.state.permissionTemplates.find(t => t.id === id);\n    if (!template) {\n      return null;\n    }\n\n    return (\n      <Template\n        refresh={this.requestPermissions}\n        template={template}\n        topQualifiers={this.props.topQualifiers}\n      />\n    );\n  }\n\n  renderHome() {\n    return (\n      <Home\n        permissionTemplates={this.state.permissionTemplates}\n        permissions={this.state.permissions}\n        ready={this.state.ready}\n        refresh={this.requestPermissions}\n        topQualifiers={this.props.topQualifiers}\n      />\n    );\n  }\n\n  render() {\n    const { id } = this.props.location.query;\n    return (\n      <div>\n        <Suggestions suggestions=\"permission_templates\" />\n        <Helmet defer={false} title={translate('permission_templates.page')} />\n\n        {id && this.renderTemplate(id)}\n        {!id && this.renderHome()}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state: Store) => ({ topQualifiers: getAppState(state).qualifiers });\n\nexport default connect(mapStateToProps)(App);\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { SuggestionsContext } from './SuggestionsContext';\n\ninterface Props {\n  suggestions: string;\n}\n\nexport default function Suggestions({ suggestions }: Props) {\n  return (\n    <SuggestionsContext.Consumer>\n      {({ addSuggestions, removeSuggestions }) => (\n        <SuggestionsInner\n          addSuggestions={addSuggestions}\n          removeSuggestions={removeSuggestions}\n          suggestions={suggestions}\n        />\n      )}\n    </SuggestionsContext.Consumer>\n  );\n}\n\ninterface SuggestionsInnerProps {\n  addSuggestions: (key: string) => void;\n  removeSuggestions: (key: string) => void;\n  suggestions: string;\n}\n\nclass SuggestionsInner extends React.PureComponent<SuggestionsInnerProps> {\n  componentDidMount() {\n    this.props.addSuggestions(this.props.suggestions);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.suggestions !== this.props.suggestions) {\n      this.props.removeSuggestions(this.props.suggestions);\n      this.props.addSuggestions(prevProps.suggestions);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.removeSuggestions(this.props.suggestions);\n  }\n\n  render() {\n    return null;\n  }\n}\n"],"sourceRoot":""}