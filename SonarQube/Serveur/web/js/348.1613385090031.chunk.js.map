{"version":3,"sources":["webpack:///./src/main/js/api/user_groups.ts","webpack:///./src/main/js/apps/groups/components/DeleteForm.tsx","webpack:///./src/main/js/apps/groups/components/Form.tsx","webpack:///./src/main/js/apps/groups/components/Header.tsx","webpack:///./src/main/js/apps/groups/components/EditMembersModal.tsx","webpack:///./src/main/js/apps/groups/components/EditMembers.tsx","webpack:///./src/main/js/apps/groups/components/ListItem.tsx","webpack:///./src/main/js/apps/groups/components/List.tsx","webpack:///./src/main/js/apps/groups/components/App.tsx","webpack:///./src/main/js/app/components/embed-docs-modal/Suggestions.tsx"],"names":["searchUsersGroups","data","catch","getUsersInGroup","addUserToGroup","removeUserFromGroup","createGroup","then","r","updateGroup","deleteGroup","DeleteForm","group","onClose","onSubmit","header","onCloseClick","onFormSubmit","submitting","className","name","loading","disabled","onClick","props","handleSubmit","description","state","handleDescriptionChange","event","setState","currentTarget","value","handleNameChange","render","this","size","htmlFor","autoFocus","id","maxLength","onChange","required","type","confirmButtonText","mounted","createModal","handleCreateClick","handleClose","onCreate","componentDidMount","componentWillUnmount","fetchUsers","searchParams","p","page","ps","pageSize","q","query","undefined","selected","filter","prevState","more","users","newSelectedUsers","user","map","selectedUsers","needToReload","lastSearchParams","usersTotalCount","total","handleSelect","login","handleUnselect","renderElement","modalHeader","contentLabel","onRequestClose","elements","elementsTotalCount","SelectList","All","onSearch","onSelect","onUnselect","selectedElements","withPaging","modal","handleMembersClick","handleModalClose","onEdit","title","ListItem","default","membersCount","onEditMembers","ActionsDropdown","destructive","onDelete","List","colSpan","showAnyone","key","groups","makeFetchGroupsRequest","stopLoading","fetchGroups","paging","fetchMoreGroups","currentPaging","pageIndex","search","refresh","closeDeleteForm","groupToBeDeleted","closeEditForm","editedGroup","openDeleteForm","openEditForm","handleCreate","handleDelete","handleEdit","includes","toLowerCase","Suggestions","suggestions","defer","minLength","placeholder","count","length","loadMore","ready","Consumer","addSuggestions","removeSuggestions","SuggestionsInner","componentDidUpdate","prevProps"],"mappings":"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","file":"js/348.1613385090031.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON, post, postJSON } from 'sonar-ui-common/helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\n\nexport function searchUsersGroups(data: {\n  f?: string;\n  p?: number;\n  ps?: number;\n  q?: string;\n}): Promise<{ groups: T.Group[]; paging: T.Paging }> {\n  return getJSON('/api/user_groups/search', data).catch(throwGlobalError);\n}\n\nexport function getUsersInGroup(data: {\n  id?: number;\n  name?: string;\n  p?: number;\n  ps?: number;\n  q?: string;\n  selected?: string;\n}): Promise<T.Paging & { users: T.UserSelected[] }> {\n  return getJSON('/api/user_groups/users', data).catch(throwGlobalError);\n}\n\nexport function addUserToGroup(data: { id?: string; name?: string; login?: string }) {\n  return post('/api/user_groups/add_user', data).catch(throwGlobalError);\n}\n\nexport function removeUserFromGroup(data: { id?: string; name?: string; login?: string }) {\n  return post('/api/user_groups/remove_user', data).catch(throwGlobalError);\n}\n\nexport function createGroup(data: { description?: string; name: string }): Promise<T.Group> {\n  return postJSON('/api/user_groups/create', data).then(r => r.group, throwGlobalError);\n}\n\nexport function updateGroup(data: { description?: string; id: number; name?: string }) {\n  return post('/api/user_groups/update', data).catch(throwGlobalError);\n}\n\nexport function deleteGroup(data: { name: string }) {\n  return post('/api/user_groups/delete', data).catch(throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport SimpleModal from 'sonar-ui-common/components/controls/SimpleModal';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  group: T.Group;\n  onClose: () => void;\n  onSubmit: () => Promise<void>;\n}\n\nexport default function DeleteForm({ group, onClose, onSubmit }: Props) {\n  const header = translate('groups.delete_group');\n\n  return (\n    <SimpleModal header={header} onClose={onClose} onSubmit={onSubmit}>\n      {({ onCloseClick, onFormSubmit, submitting }) => (\n        <form onSubmit={onFormSubmit}>\n          <header className=\"modal-head\">\n            <h2>{header}</h2>\n          </header>\n\n          <div className=\"modal-body\">\n            {translateWithParameters('groups.delete_group.confirmation', group.name)}\n          </div>\n\n          <footer className=\"modal-foot\">\n            <DeferredSpinner className=\"spacer-right\" loading={submitting} />\n            <SubmitButton className=\"button-red\" disabled={submitting}>\n              {translate('delete')}\n            </SubmitButton>\n            <ResetButtonLink disabled={submitting} onClick={onCloseClick}>\n              {translate('cancel')}\n            </ResetButtonLink>\n          </footer>\n        </form>\n      )}\n    </SimpleModal>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport SimpleModal from 'sonar-ui-common/components/controls/SimpleModal';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  confirmButtonText: string;\n  group?: T.Group;\n  header: string;\n  onClose: () => void;\n  onSubmit: (data: { description: string; name: string }) => Promise<void>;\n}\n\ninterface State {\n  description: string;\n  name: string;\n}\n\nexport default class Form extends React.PureComponent<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      description: (props.group && props.group.description) || '',\n      name: (props.group && props.group.name) || ''\n    };\n  }\n\n  handleSubmit = () => {\n    return this.props\n      .onSubmit({ description: this.state.description, name: this.state.name })\n      .then(this.props.onClose);\n  };\n\n  handleDescriptionChange = (event: React.SyntheticEvent<HTMLTextAreaElement>) => {\n    this.setState({ description: event.currentTarget.value });\n  };\n\n  handleNameChange = (event: React.SyntheticEvent<HTMLInputElement>) => {\n    this.setState({ name: event.currentTarget.value });\n  };\n\n  render() {\n    return (\n      <SimpleModal\n        header={this.props.header}\n        onClose={this.props.onClose}\n        onSubmit={this.handleSubmit}\n        size=\"small\">\n        {({ onCloseClick, onFormSubmit, submitting }) => (\n          <form onSubmit={onFormSubmit}>\n            <header className=\"modal-head\">\n              <h2>{this.props.header}</h2>\n            </header>\n\n            <div className=\"modal-body\">\n              <div className=\"modal-field\">\n                <label htmlFor=\"create-group-name\">\n                  {translate('name')}\n                  <em className=\"mandatory\">*</em>\n                </label>\n                <input\n                  autoFocus={true}\n                  id=\"create-group-name\"\n                  maxLength={255}\n                  name=\"name\"\n                  onChange={this.handleNameChange}\n                  required={true}\n                  size={50}\n                  type=\"text\"\n                  value={this.state.name}\n                />\n              </div>\n              <div className=\"modal-field\">\n                <label htmlFor=\"create-group-description\">{translate('description')}</label>\n                <textarea\n                  id=\"create-group-description\"\n                  name=\"description\"\n                  onChange={this.handleDescriptionChange}\n                  value={this.state.description}\n                />\n              </div>\n            </div>\n\n            <footer className=\"modal-foot\">\n              <DeferredSpinner className=\"spacer-right\" loading={submitting} />\n              <SubmitButton disabled={submitting}>{this.props.confirmButtonText}</SubmitButton>\n              <ResetButtonLink onClick={onCloseClick}>{translate('cancel')}</ResetButtonLink>\n            </footer>\n          </form>\n        )}\n      </SimpleModal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport Form from './Form';\n\ninterface Props {\n  onCreate: (data: { description: string; name: string }) => Promise<void>;\n}\n\ninterface State {\n  createModal: boolean;\n}\n\nexport default class Header extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { createModal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleCreateClick = () => {\n    this.setState({ createModal: true });\n  };\n\n  handleClose = () => {\n    if (this.mounted) {\n      this.setState({ createModal: false });\n    }\n  };\n\n  handleSubmit = (data: { name: string; description: string }) => {\n    return this.props.onCreate(data);\n  };\n\n  render() {\n    return (\n      <>\n        <header className=\"page-header\" id=\"groups-header\">\n          <h1 className=\"page-title\">{translate('user_groups.page')}</h1>\n\n          <div className=\"page-actions\">\n            <Button id=\"groups-create\" onClick={this.handleCreateClick}>\n              {translate('groups.create_group')}\n            </Button>\n          </div>\n\n          <p className=\"page-description\">{translate('user_groups.page.description')}</p>\n        </header>\n        {this.state.createModal && (\n          <Form\n            confirmButtonText={translate('create')}\n            header={translate('groups.create_group')}\n            onClose={this.handleClose}\n            onSubmit={this.handleSubmit}\n          />\n        )}\n      </>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { find, without } from 'lodash';\nimport * as React from 'react';\nimport { ResetButtonLink } from 'sonar-ui-common/components/controls/buttons';\nimport Modal from 'sonar-ui-common/components/controls/Modal';\nimport SelectList, {\n  SelectListFilter,\n  SelectListSearchParams\n} from 'sonar-ui-common/components/controls/SelectList';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { addUserToGroup, getUsersInGroup, removeUserFromGroup } from '../../../api/user_groups';\n\ninterface Props {\n  group: T.Group;\n  onClose: () => void;\n}\n\ninterface State {\n  lastSearchParams?: SelectListSearchParams;\n  needToReload: boolean;\n  users: T.UserSelected[];\n  usersTotalCount?: number;\n  selectedUsers: string[];\n}\n\nexport default class EditMembersModal extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      needToReload: false,\n      users: [],\n      selectedUsers: []\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchUsers = (searchParams: SelectListSearchParams) =>\n    getUsersInGroup({\n      name: this.props.group.name,\n      p: searchParams.page,\n      ps: searchParams.pageSize,\n      q: searchParams.query !== '' ? searchParams.query : undefined,\n      selected: searchParams.filter\n    }).then(data => {\n      if (this.mounted) {\n        this.setState(prevState => {\n          const more = searchParams.page != null && searchParams.page > 1;\n\n          const users = more ? [...prevState.users, ...data.users] : data.users;\n          const newSelectedUsers = data.users.filter(user => user.selected).map(user => user.login);\n          const selectedUsers = more\n            ? [...prevState.selectedUsers, ...newSelectedUsers]\n            : newSelectedUsers;\n\n          return {\n            needToReload: false,\n            lastSearchParams: searchParams,\n            loading: false,\n            users,\n            usersTotalCount: data.total,\n            selectedUsers\n          };\n        });\n      }\n    });\n\n  handleSelect = (login: string) =>\n    addUserToGroup({\n      name: this.props.group.name,\n      login\n    }).then(() => {\n      if (this.mounted) {\n        this.setState((state: State) => ({\n          needToReload: true,\n          selectedUsers: [...state.selectedUsers, login]\n        }));\n      }\n    });\n\n  handleUnselect = (login: string) =>\n    removeUserFromGroup({\n      name: this.props.group.name,\n      login\n    }).then(() => {\n      if (this.mounted) {\n        this.setState((state: State) => ({\n          needToReload: true,\n          selectedUsers: without(state.selectedUsers, login)\n        }));\n      }\n    });\n\n  renderElement = (login: string): React.ReactNode => {\n    const user = find(this.state.users, { login });\n    return (\n      <div className=\"select-list-list-item\">\n        {user === undefined ? (\n          login\n        ) : (\n          <>\n            {user.name}\n            <br />\n            <span className=\"note\">{user.login}</span>\n          </>\n        )}\n      </div>\n    );\n  };\n\n  render() {\n    const modalHeader = translate('users.update');\n    return (\n      <Modal contentLabel={modalHeader} onRequestClose={this.props.onClose}>\n        <header className=\"modal-head\">\n          <h2>{modalHeader}</h2>\n        </header>\n\n        <div className=\"modal-body modal-container\">\n          <SelectList\n            elements={this.state.users.map(user => user.login)}\n            elementsTotalCount={this.state.usersTotalCount}\n            needToReload={\n              this.state.needToReload &&\n              this.state.lastSearchParams &&\n              this.state.lastSearchParams.filter !== SelectListFilter.All\n            }\n            onSearch={this.fetchUsers}\n            onSelect={this.handleSelect}\n            onUnselect={this.handleUnselect}\n            renderElement={this.renderElement}\n            selectedElements={this.state.selectedUsers}\n            withPaging={true}\n          />\n        </div>\n\n        <footer className=\"modal-foot\">\n          <ResetButtonLink onClick={this.props.onClose}>{translate('Done')}</ResetButtonLink>\n        </footer>\n      </Modal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ButtonIcon } from 'sonar-ui-common/components/controls/buttons';\nimport BulletListIcon from 'sonar-ui-common/components/icons/BulletListIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport EditMembersModal from './EditMembersModal';\n\ninterface Props {\n  group: T.Group;\n  onEdit: () => void;\n}\n\ninterface State {\n  modal: boolean;\n}\n\nexport default class EditMembers extends React.PureComponent<Props, State> {\n  container?: HTMLElement | null;\n  mounted = false;\n  state: State = { modal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleMembersClick = () => {\n    this.setState({ modal: true });\n  };\n\n  handleModalClose = () => {\n    if (this.mounted) {\n      this.setState({ modal: false });\n      this.props.onEdit();\n    }\n  };\n\n  render() {\n    return (\n      <>\n        <ButtonIcon\n          aria-label={translate('groups.users.edit')}\n          className=\"button-small\"\n          onClick={this.handleMembersClick}\n          title={translate('groups.users.edit')}>\n          <BulletListIcon />\n        </ButtonIcon>\n        {this.state.modal && (\n          <EditMembersModal group={this.props.group} onClose={this.handleModalClose} />\n        )}\n      </>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ActionsDropdown, {\n  ActionsDropdownDivider,\n  ActionsDropdownItem\n} from 'sonar-ui-common/components/controls/ActionsDropdown';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport EditMembers from './EditMembers';\n\nexport interface ListItemProps {\n  group: T.Group;\n  onDelete: (group: T.Group) => void;\n  onEdit: (group: T.Group) => void;\n  onEditMembers: () => void;\n}\n\nexport default function ListItem(props: ListItemProps) {\n  const { group } = props;\n\n  return (\n    <tr data-id={group.name}>\n      <td className=\"width-20\">\n        <strong className=\"js-group-name\">{group.name}</strong>\n        {group.default && <span className=\"little-spacer-left\">({translate('default')})</span>}\n      </td>\n\n      <td className=\"thin text-middle text-right little-padded-right\">{group.membersCount}</td>\n      <td className=\"little-padded-left\">\n        {!group.default && <EditMembers group={group} onEdit={props.onEditMembers} />}\n      </td>\n\n      <td className=\"width-40\">\n        <span className=\"js-group-description\">{group.description}</span>\n      </td>\n\n      <td className=\"thin nowrap text-right\">\n        {!group.default && (\n          <ActionsDropdown>\n            <ActionsDropdownItem className=\"js-group-update\" onClick={() => props.onEdit(group)}>\n              {translate('update_details')}\n            </ActionsDropdownItem>\n            <ActionsDropdownDivider />\n            <ActionsDropdownItem\n              className=\"js-group-delete\"\n              destructive={true}\n              onClick={() => props.onDelete(group)}>\n              {translate('delete')}\n            </ActionsDropdownItem>\n          </ActionsDropdown>\n        )}\n      </td>\n    </tr>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { sortBy } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport ListItem from './ListItem';\n\ninterface Props {\n  groups: T.Group[];\n  onDelete: (group: T.Group) => void;\n  onEdit: (group: T.Group) => void;\n  onEditMembers: () => void;\n  showAnyone: boolean;\n}\n\nexport default function List(props: Props) {\n  return (\n    <div className=\"boxed-group boxed-group-inner\">\n      <table className=\"data zebra zebra-hover\" id=\"groups-list\">\n        <thead>\n          <tr>\n            <th />\n            <th className=\"nowrap width-10\" colSpan={2}>\n              {translate('members')}\n            </th>\n            <th className=\"nowrap\">{translate('description')}</th>\n            <th />\n          </tr>\n        </thead>\n        <tbody>\n          {props.showAnyone && (\n            <tr className=\"js-anyone\" key=\"anyone\">\n              <td className=\"width-20\">\n                <strong className=\"js-group-name\">{translate('groups.anyone')}</strong>\n              </td>\n              <td className=\"width-10\" colSpan={2} />\n              <td className=\"width-40\" colSpan={2}>\n                <span className=\"js-group-description\">\n                  {translate('user_groups.anyone.description')}\n                </span>\n              </td>\n            </tr>\n          )}\n\n          {sortBy(props.groups, group => group.name.toLowerCase()).map(group => (\n            <ListItem\n              group={group}\n              key={group.name}\n              onDelete={props.onDelete}\n              onEdit={props.onEdit}\n              onEditMembers={props.onEditMembers}\n            />\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport ListFooter from 'sonar-ui-common/components/controls/ListFooter';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { omitNil } from 'sonar-ui-common/helpers/request';\nimport { createGroup, deleteGroup, searchUsersGroups, updateGroup } from '../../../api/user_groups';\nimport Suggestions from '../../../app/components/embed-docs-modal/Suggestions';\nimport DeleteForm from './DeleteForm';\nimport Form from './Form';\nimport Header from './Header';\nimport List from './List';\n\ninterface State {\n  groups?: T.Group[];\n  editedGroup?: T.Group;\n  groupToBeDeleted?: T.Group;\n  loading: boolean;\n  paging?: T.Paging;\n  query: string;\n}\n\nexport default class App extends React.PureComponent<{}, State> {\n  mounted = false;\n  state: State = { loading: true, query: '' };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchGroups();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  makeFetchGroupsRequest = (data?: { p?: number; q?: string }) => {\n    this.setState({ loading: true });\n    return searchUsersGroups({\n      q: this.state.query,\n      ...data\n    });\n  };\n\n  stopLoading = () => {\n    if (this.mounted) {\n      this.setState({ loading: false });\n    }\n  };\n\n  fetchGroups = async (data?: { p?: number; q?: string }) => {\n    try {\n      const { groups, paging } = await this.makeFetchGroupsRequest(data);\n      if (this.mounted) {\n        this.setState({ groups, loading: false, paging });\n      }\n    } catch {\n      this.stopLoading();\n    }\n  };\n\n  fetchMoreGroups = async () => {\n    const { paging: currentPaging } = this.state;\n    if (currentPaging && currentPaging.total > currentPaging.pageIndex * currentPaging.pageSize) {\n      try {\n        const { groups, paging } = await this.makeFetchGroupsRequest({\n          p: currentPaging.pageIndex + 1\n        });\n        if (this.mounted) {\n          this.setState(({ groups: existingGroups = [] }) => ({\n            groups: [...existingGroups, ...groups],\n            loading: false,\n            paging\n          }));\n        }\n      } catch {\n        this.stopLoading();\n      }\n    }\n  };\n\n  search = (query: string) => {\n    this.fetchGroups({ q: query });\n    this.setState({ query });\n  };\n\n  refresh = async () => {\n    const { paging, query } = this.state;\n\n    await this.fetchGroups({ q: query });\n\n    // reload all pages in order\n    if (paging && paging.pageIndex > 1) {\n      for (let p = 1; p < paging.pageIndex; p++) {\n        // eslint-disable-next-line no-await-in-loop\n        await this.fetchMoreGroups(); // This is a intentional promise chain\n      }\n    }\n  };\n\n  closeDeleteForm = () => {\n    this.setState({ groupToBeDeleted: undefined });\n  };\n\n  closeEditForm = () => {\n    this.setState({ editedGroup: undefined });\n  };\n\n  openDeleteForm = (group: T.Group) => {\n    this.setState({ groupToBeDeleted: group });\n  };\n\n  openEditForm = (group: T.Group) => {\n    this.setState({ editedGroup: group });\n  };\n\n  handleCreate = async (data: { description: string; name: string }) => {\n    await createGroup({ ...data });\n\n    await this.refresh();\n  };\n\n  handleDelete = async () => {\n    const { groupToBeDeleted } = this.state;\n\n    if (!groupToBeDeleted) {\n      return;\n    }\n\n    await deleteGroup({ name: groupToBeDeleted.name });\n\n    await this.refresh();\n\n    if (this.mounted) {\n      this.setState({ groupToBeDeleted: undefined });\n    }\n  };\n\n  handleEdit = async ({ name, description }: { name?: string; description: string }) => {\n    const { editedGroup } = this.state;\n\n    if (!editedGroup) {\n      return;\n    }\n\n    const data = {\n      description,\n      id: editedGroup.id,\n      // pass `name` only if it has changed, otherwise the WS fails\n      ...omitNil({ name: name !== editedGroup.name ? name : undefined })\n    };\n\n    await updateGroup(data);\n\n    if (this.mounted) {\n      this.setState(({ groups = [] }: State) => ({\n        editedGroup: undefined,\n        groups: groups.map(group =>\n          group.name === editedGroup.name ? { ...group, ...data } : group\n        )\n      }));\n    }\n  };\n\n  render() {\n    const { editedGroup, groupToBeDeleted, groups, loading, paging, query } = this.state;\n\n    const showAnyone = 'anyone'.includes(query.toLowerCase());\n\n    return (\n      <>\n        <Suggestions suggestions=\"user_groups\" />\n        <Helmet defer={false} title={translate('user_groups.page')} />\n        <div className=\"page page-limited\" id=\"groups-page\">\n          <Header onCreate={this.handleCreate} />\n\n          <SearchBox\n            className=\"big-spacer-bottom\"\n            id=\"groups-search\"\n            minLength={2}\n            onChange={this.search}\n            placeholder={translate('search.search_by_name')}\n            value={query}\n          />\n\n          {groups !== undefined && (\n            <List\n              groups={groups}\n              onDelete={this.openDeleteForm}\n              onEdit={this.openEditForm}\n              onEditMembers={this.refresh}\n              showAnyone={showAnyone}\n            />\n          )}\n\n          {groups !== undefined && paging !== undefined && (\n            <div id=\"groups-list-footer\">\n              <ListFooter\n                count={showAnyone ? groups.length + 1 : groups.length}\n                loading={loading}\n                loadMore={this.fetchMoreGroups}\n                ready={!loading}\n                total={showAnyone ? paging.total + 1 : paging.total}\n              />\n            </div>\n          )}\n\n          {groupToBeDeleted && (\n            <DeleteForm\n              group={groupToBeDeleted}\n              onClose={this.closeDeleteForm}\n              onSubmit={this.handleDelete}\n            />\n          )}\n\n          {editedGroup && (\n            <Form\n              confirmButtonText={translate('update_verb')}\n              group={editedGroup}\n              header={translate('groups.update_group')}\n              onClose={this.closeEditForm}\n              onSubmit={this.handleEdit}\n            />\n          )}\n        </div>\n      </>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2021 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { SuggestionsContext } from './SuggestionsContext';\n\ninterface Props {\n  suggestions: string;\n}\n\nexport default function Suggestions({ suggestions }: Props) {\n  return (\n    <SuggestionsContext.Consumer>\n      {({ addSuggestions, removeSuggestions }) => (\n        <SuggestionsInner\n          addSuggestions={addSuggestions}\n          removeSuggestions={removeSuggestions}\n          suggestions={suggestions}\n        />\n      )}\n    </SuggestionsContext.Consumer>\n  );\n}\n\ninterface SuggestionsInnerProps {\n  addSuggestions: (key: string) => void;\n  removeSuggestions: (key: string) => void;\n  suggestions: string;\n}\n\nclass SuggestionsInner extends React.PureComponent<SuggestionsInnerProps> {\n  componentDidMount() {\n    this.props.addSuggestions(this.props.suggestions);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.suggestions !== this.props.suggestions) {\n      this.props.removeSuggestions(this.props.suggestions);\n      this.props.addSuggestions(prevProps.suggestions);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.removeSuggestions(this.props.suggestions);\n  }\n\n  render() {\n    return null;\n  }\n}\n"],"sourceRoot":""}